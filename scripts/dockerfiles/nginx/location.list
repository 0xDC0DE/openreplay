location ~* /general_stats {
      deny all;
}
location /healthz {
  return 200 'OK';
}
location /ingest/ {
  rewrite ^/ingest/(.*) /$1 break;
  proxy_http_version 1.1;
  proxy_set_header Upgrade $http_upgrade;
  proxy_set_header Connection "Upgrade";
  proxy_set_header X-Forwarded-For $real_ip;
  proxy_set_header X-Forwarded-Host $real_ip;
  proxy_set_header X-Real-IP $real_ip;
  proxy_set_header Host $host;
  set $target http://http-openreplay:8080;
  proxy_pass $target;
  proxy_read_timeout 300;
  proxy_connect_timeout 120;
  proxy_send_timeout 300;
}
location /api/ {
  rewrite ^/api/(.*) /$1 break;
  proxy_http_version 1.1;
  proxy_set_header Upgrade $http_upgrade;
  proxy_set_header Connection "Upgrade";
  proxy_set_header Host $host;
  proxy_set_header X-Forwarded-Proto $scheme;
  set $target http://chalice-openreplay:8000;
  proxy_pass $target;
}
location /assist/ {
  rewrite ^/assist/(.*) /$1 break;
  proxy_http_version 1.1;
  proxy_set_header Upgrade $http_upgrade;
  proxy_set_header Connection "Upgrade";
  proxy_set_header Host $host;
  set $target http://utilities-openreplay:9000;
  proxy_pass $target;
}
location / {
  index /index.html;
  rewrite ^((?!.(js|css|png|svg|jpg|woff|woff2)).)*$ /frontend/index.html break;
  include /etc/nginx/conf.d/compression.conf;
  proxy_set_header Host $http_host;
  set $target http://frontend:8080/;
  proxy_pass $target;
  proxy_intercept_errors on; # see http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_intercept_errors
  add_header hello 'rajesh';
  error_page 404 =200 /index.html;
}
